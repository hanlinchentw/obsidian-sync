**Goal: Learn to write the same low-level code as we did with assembler, but in C**
## Compile

Create a dummy C file
```
void func() {
    char *string = "Hello";
}
```

To compile system-independent code, we need the flag `-ffreestanding`
```
i686-elf-gcc -ffreestanding -c myFile.c -o myFile.o
```
Let's examine the machine code generated by the compiler:

`i386-elf-objdump -d myFile.o`

```
myFile.o:     file format elf32-i386


Disassembly of section .text:

00000000 <func>:
   0:	55                   	push   %ebp
   1:	89 e5                	mov    %esp,%ebp
   3:	83 ec 10             	sub    $0x10,%esp
   6:	c7 45 fc 00 00 00 00 	movl   $0x0,-0x4(%ebp)
   d:	90                   	nop
   e:	c9                   	leave
   f:	c3                   	ret
```
## Link
Finally, to produce a binary(.bin) file, we will use the linker. For this example, we'll place the offset at `0x0` and use the `binary` format which generates machine code without any labels and/or metadata

`i686-elf-ld -o myFile.bin -Ttext 0x0 --oformat binary myFile.o`

_Note: a warning may appear when linking, disregard it_

Now examine both "binary" files, myFile.o and myFile.bin` using `xxd`.
You will see that the `.bin` file is machine code, while the `.o` file has a lot of debugging information, labels, etc.

```
> xxd myFile.bin
00000000: 5589 e583 ec10 c745 fc10 0000 0090 c9c3  U......E........
00000010: 4865 6c6c 6f00                           Hello.
```

```
❯ xxd myFile.o
00000000: 7f45 4c46 0101 0100 0000 0000 0000 0000  .ELF............
00000010: 0100 0300 0100 0000 0000 0000 0000 0000  ................
00000020: a000 0000 0000 0000 3400 0000 0000 2800  ........4.....(.
00000030: 0a00 0700 5589 e583 ec10 c745 fc00 0000  ....U......E....
00000040: 0090 c9c3 4865 6c6c 6f00 0047 4343 3a20  ....Hello..GCC:
00000050: 2847 4e55 2920 3135 2e31 2e30 0000 2e73  (GNU) 15.1.0...s
00000060: 796d 7461 6200 2e73 7472 7461 6200 2e73  ymtab..strtab..s
...continue
```

## Decompile
As a curiosity, we will examine the machine code.
```
❯ ndisasm -b 32 myFile.bin
00000000  55                push ebp
00000001  89E5              mov ebp,esp
00000003  83EC10            sub esp,byte +0x10
00000006  C745FC10000000    mov dword [ebp-0x4],0x10
0000000D  90                nop
0000000E  C9                leave
0000000F  C3                ret
00000010  48                dec eax
00000011  656C              gs insb
00000013  6C                insb
00000014  6F                outsd
00000015  00                db 0x00
```